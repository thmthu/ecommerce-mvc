<%- include('./partials/header') %>
<%- include('./partials/sidebar') %>

    <main id="main" class="main">
      <div class="pagetitle">
        <h1>Product's Detail</h1>
        <nav>
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="index.html">Home</a></li>
            <li class="breadcrumb-item">Pages</li>
            <li class="breadcrumb-item active">Product's Detail</li>
          </ol>
        </nav>
      </div>
      <!-- End Page Title -->

      <section class="section">
        <div class="row">
          <!-- Product Image -->
          <div class="col-lg-6 d-flex justify-content-center">
            <div class="card">
              <div class="card-body d-flex justify-content-center">
                <img
                  id="product-image"
                  class="object-fit-fill"
                  src="assets/img/default-product.png"
                  alt="Product Image"
                  style="width: 150px; height: 150px"
                />
              </div>
            </div>
          </div>

          <!-- Product Details -->
          <div class="col-lg-6">
            <div class="card">
              <div class="card-body">
                <h5 id="product-name" class="card-title">Product Name</h5>
                <p id="product-description" class="fw-light">
                  Product description goes here. It will be replaced by fetched
                  data.
                </p>
                <p>Price: <b id="product-price">$0.00</b></p>
                <p>
                  <button type="button" class="btn btn-primary btn-sm">
                    <i class="bi bi-cart"></i>
                    <b> Add to Cart </b>
                  </button>
                </p>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
    <!-- End #main -->

    <!-- ======= Footer ======= -->
    <footer id="footer" class="footer">
      <div class="copyright">
        &copy; Copyright <strong><span>NiceAdmin</span></strong
        >. All Rights Reserved
      </div>
      <div class="credits">
        Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
      </div>
    </footer>
    <!-- End Footer -->

    <a
      href="#"
      class="back-to-top d-flex align-items-center justify-content-center"
      ><i class="bi bi-arrow-up-short"></i
    ></a>
    <script>
      async function fetchProductDetails(productId) {
        try {
          // Fetch data from the API endpoint with the product ID
          const response = await fetch(
            `http://localhost:3055/v1/api/product/${productId}`
          );

          // Check if the response is okay
          if (!response.ok) {
            throw new Error(
              "Network response was not ok " + response.statusText
            );
          }

          const res = await response.json();
          const product = res.metadata;

          // Update the HTML elements with the fetched data
          document.getElementById("product-name").innerText =
            product.product_name;
          document.getElementById("product-description").innerText =
            product.product_description;
          document.getElementById(
            "product-price"
          ).innerText = `$${product.product_price}`;
          document.getElementById("product-image").src =
            product.product_thumb || "assets/img/default-product.png";
        } catch (error) {
          console.error("Error fetching product details:", error);
          alert("Failed to load product details.");
        }
      }

      // Extract the product ID from the URL and fetch product details
      document.addEventListener("DOMContentLoaded", () => {
        const urlParams = new URLSearchParams(window.location.search);
        const productId = urlParams.get("id");
        if (productId) {
          fetchProductDetails(productId);
        } else {
          alert("No product ID found in the URL.");
        }
      });
    </script>
    <!-- Vendor JS Files -->
    <script src="assets/vendor/apexcharts/apexcharts.min.js"></script>
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/vendor/chart.js/chart.umd.js"></script>
    <script src="assets/vendor/echarts/echarts.min.js"></script>
    <script src="assets/vendor/quill/quill.js"></script>
    <script src="assets/vendor/simple-datatables/simple-datatables.js"></script>
    <script src="assets/vendor/tinymce/tinymce.min.js"></script>
    <script src="assets/vendor/php-email-form/validate.js"></script>

    <!-- Template Main JS File -->
    <script src="assets/js/main.js"></script>
  </body>
</html>
